var Cardgame={cards:[],playerHand:[],AIHand:[],init:function(){this.cacheDom(),this.bindEvents(),this.createDeck(),this.shuffleDeck(),this.renderDeck()},cacheDom:function(){this.$deck=$("#deck"),this.$btnDeal=$("#btn-deal"),this.$btnChange=$("#btn-change"),this.$playerPane=$("#player-pane"),this.$AIPane=$("#ai-pane"),this.$cardSlots=$(".card-slots"),this.$wasteDiv=$("#waste")},bindEvents:function(){var t=this;this.$btnDeal.on("click",function(){t.dealCards()}),this.$btnChange.on("click",t.changeCards),$("#player-pane .card-slot").on("click",t.selectCard)},createDeck:function(){for(var t=["2","3","4","5","6","7","8","9","10","J","Q","K","A"],e=["Hearts","Diamonds","Spades","Clubs"],a=0;a<t.length;a++)for(var s=0;s<e.length;s++){var i=(t[a]+"_of_"+e[s]+".png").toLowerCase();this.cards.push({rank:t[a],suit:e[s],img:i})}},shuffleDeck:function(){for(var t=[],e,a=this.cards.length;a>0;a--)e=Math.floor(Math.random()*a),t.push(this.cards[e]),this.cards.splice(e,1);this.cards=t},renderDeck:function(){for(var t="",e="",a,s=this.cards.length-1;s>=0;s--)a=(this.cards.length-s)/4,e=this.cards[s].suit.toLowerCase()+"-"+this.cards[s].rank.toLowerCase(),t+='<div class="card" style="top: '+a+"px; left: "+a+"px; z-index: "+s+'">',t+='<figure class="back"></figure>',t+='<figure class="front '+e+'"></figure>',t+="</div>";this.$deck.append(t)},dealCards:function(){var t=this,e=t.getEmptySlots().length,a=[0,5,1,6,2,7,3,8,4,9],s=t.$deck.children().slice(0,e);if(10===e)for(var i=0;i<a.length;i++){var n=$("#slot-"+a[i]),r=$(s[i]);t.animateCard(r,n,i,e)}else this.getEmptySlots().each(function(a){var i=$(this),n=$(s[a]);t.animateCard(n,i,a,e)})},animateCard:function(t,e,a,s){var i=this,n=200,r=e.offset().top-this.$deck.offset().top+5,o=e.offset().left-this.$deck.offset().left+5;setTimeout(function(){t.addClass("rotate").animate({top:r,left:o},n,function(){t.remove().appendTo("#"+e.attr("id")).css({position:"static","z-index":a}).removeClass("rotate"),a===s-1&&i.flipPlayerCards(s)})},(n+100)*a)},flipPlayerCards:function(t){var e=$(".card-slot"),a=100,s=this;e.each(function(t){if(t<5){var e=$(this);setTimeout(function(){e.children("div").addClass("face-up"),4===t&&(s.$btnDeal.attr("disabled",!0),s.$btnChange.attr("disabled",!1))},a*t)}})},selectCard:function(){var t=$(this);t.hasClass("selected-card")?t.stop().animate({marginTop:0,opacity:1},200):t.stop().animate({marginTop:-10,opacity:.5},50),t.toggleClass("selected-card")},changeCards:function(){var t=$(".selected-card"),e=400,a=this;t.each(function(t){var a=$(this).children(".card"),s=$("#waste").offset().top-a.offset().top,i=$("#waste").offset().left-a.offset().left,n=20+Math.round(340*Math.random());console.log(n),setTimeout(function(){a.css({position:"absolute",top:5,left:5}).addClass("rotated-"+n).animate({top:s,left:i},1e3)},e*t)})},getEmptySlots:function(){return $(".card-slot:not(:has(div))")},changeInstruction:function(t){$(".instruction").text(t)}};Cardgame.init();